SET DATEFORMAT dmy SELECT Produto.CodigoInterno as 'Codigo Interno', Produto.Nome as Produto, Produto.Grupo, Convert(Numeric(15,3), Produto.ValorCusto) as 'Valor Custo', (SELECT case when sum(EntradaNf.QtdProd) is null then 0 else sum(EntradaNf.QtdProd) end FROM EntradaNf left join TotalEntradaNf on EntradaNf.CodTotNf = TotalEntradaNf.Codigo where EntradaNf.CodProd = Produto. Codigo and EstoqueOk = 'True' and TotalEntradaNF.Data <= 'DATAINICIALRELATORIO' and EntradaNf.CodConfig = 1) - (SELECT case when sum(Pedido.Qtd) is null then 0 else sum(Pedido.Qtd) end FROM Pedido left join Total on Pedido.CodOrdem = Total.CodOrdem and PEdido.CodConfig = Total.CodConfig where Pedido.CodConfig = 1 and Pedido.CodProd = Produto.Codigo and Pedido.Devolvido = 'False' and Total.Data <= 'DATAINICIALRELATORIO') + (SELECT case when sum(AjusteQtde.Qtd) is null then 0 else  sum(AjusteQtde.Qtd) end FROM AjusteQtde where AjusteQtde.CodConfig = 1 and AjusteQtde.CodProd = Produto.Codigo and AjusteQtde.Data <= 'DATAINICIALRELATORIO') as Qtd FROM Produto left join Qtde on Produto.Codigo = Qtde.CodProd where Produto.Inativo = 'False'  group by Produto.Nome, Produto.ValorCusto, Produto.CodigoInterno, Produto.Grupo, Produto.Codigo