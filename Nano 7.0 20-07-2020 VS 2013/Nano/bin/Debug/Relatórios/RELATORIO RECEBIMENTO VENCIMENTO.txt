SET DATEFORMAT dmy (SELECT convert(integer,Recebimento.CodOrdem) as CodigoPedido, Pagamento, Convert(Numeric(15,2),Recebimento.Valor) as ValorVenda, Convert(Numeric(15,2),Recebimento.Valor) as Valor, Recebimento.Data, Recebimento.CodConfig, convert(varchar(10),'OK') as RecebidoOK, Recebimento.Data as DataVenda FROM Recebimento left join Pagamento on Recebimento.Pagamento = Pagamento.Descricao where Recebimento.FormaPagamento = 'A VISTA' and Prazo = 'False' and Recebimento.Data >= '01/07/2019' AND Recebimento.Data <= '22/07/2019')UNION ALL (SELECT convert(integer,ContaReceber.CodOrdem) as CodigoPedido, Pagamento, Convert(Numeric(15,2),ValorParcela) as ValorVenda, Convert(Numeric(15,2),ValorParcela) as Valor, Vencimento as Data, ContaReceber.CodConfig, case when RecebidoOK = 'True' then convert(varchar(10),'OK') else convert(varchar(10),'NOK') end as RecebidoOK, Total.Data as DataVenda FROM ContaReceber left join Total on ContaReceber.CodOrdem = Total.CodOrdem and ContaReceber.CodConfig = Total.CodConfig where RecebidoOK = 'False' and Vencimento >= '01/07/2019' AND Vencimento <= '22/07/2019')UNION ALL (SELECT convert(integer,ContaReceber.CodOrdem) as CodigoPedido, Pagamento, Convert(Numeric(15,2),ValorParcela) as ValorVenda, Convert(Numeric(15,2),ValorRecebido) as Valor, Recebimento as Data, ContaReceber.CodConfig, case when RecebidoOK = 'True' then convert(varchar(10),'OK') else convert(varchar(10),'NOK') end as RecebidoOK, Total.Data as DataVenda FROM ContaReceber left join Total on ContaReceber.CodOrdem = Total.CodOrdem and ContaReceber.CodConfig = Total.CodConfig where RecebidoOK = 'True' and Recebimento >= '01/07/2019' AND Recebimento <= '22/07/2019')UNION ALL (SELECT convert(integer,Futuro.CodOrdem) as CodigoPedido, Pagamento, Convert(Numeric(15,2),Futuro.Total) as ValorVenda, Convert(Numeric(15,2),Futuro.TotalDesconto) as Valor, Futuro.Data, Futuro.CodConfig, case when Futuro.Recebido = 'True' then convert(varchar(10),'OK') else convert(varchar(10),'NOK') end as RecebidoOK, Total.Data as DataVenda FROM Futuro left join Total on Futuro.CodOrdem = Total.CodOrdem and Futuro.CodConfig = Total.CodConfig where Futuro.Data >= 'DATAINICIALRELATORIO' AND Futuro.Data <= 'DATAFINALRELATORIO')
