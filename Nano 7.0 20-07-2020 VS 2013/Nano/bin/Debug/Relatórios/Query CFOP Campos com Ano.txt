select  Nfe.CFOP, convert(numeric(15,2),sum(Pedido.ValorTotal)) as Valor, convert(varchar(10),SatFiscal.Data,103) as data FROM (SatFiscal left join Pedido on Satfiscal.CodOrdem = Pedido.CodOrdem) left join Nfe on Pedido.CodProd = Nfe.CodProd where month(SatFiscal.Data) = '10' AND Year (SatFiscal.Data) = 2017 and Nfe.regime = 'SIMPLES NACIONAL' group by  Nfe.CFOP, convert(varchar(10),SatFiscal.Data,103) order by data, cfop desc