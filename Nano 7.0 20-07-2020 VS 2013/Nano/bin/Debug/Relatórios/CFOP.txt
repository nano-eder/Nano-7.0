Select Cliente.Nome as Produto, Cliente.Cidade as Fornecedor, Sum(Pedido.Qtd) as Qtd, Convert(Numeric(15,2),Sum(ValorTotal)) as ValorTotal, Convert(Numeric(15,2),Sum(Pedido.Custo)) as Custo, Convert(Numeric(15,2),Sum(ValorTotal) - Sum(Pedido.Custo)) as Lucro, Convert(Numeric(15,2), Sum(Pedido.Custo)-Sum(Pedido.Custo)) as Porcentagem, TipoItens, Max(Total.Data) as Tamanho from (Pedido left join Total on Pedido.CodOrdem = Total.CodOrdem and Pedido.CodConfig = Total.CodConfig) left Join Cliente on Total.CodCli = Cliente.Codigo where Total.Data >= '29/11/2017' AND Total.Data <= '05/02/2018' and Pedido.CodConfig =1 and Devolvido = 'False' group by Cliente.Nome, Cliente.Cidade, TipoItens