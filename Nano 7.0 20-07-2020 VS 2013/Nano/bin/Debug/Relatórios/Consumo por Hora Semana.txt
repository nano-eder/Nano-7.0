select count(CodOrdem) as 'Qtde Venda', case when DATEPART(WEEKDAY,data) =1 then 'DOMINGO' when  DATEPART(WEEKDAY,data) =2 then 'SEGUNDA-FEIRA'  when  DATEPART(WEEKDAY,data) =3 then 'TERÇA-FEIRA'  when  DATEPART(WEEKDAY,data) =4 then 'QUARTA-FEIRA' when  DATEPART(WEEKDAY,data) =5 then 'QUINTA-FEIRA' when  DATEPART(WEEKDAY,data) =6 then 'SEXTA-FEIRA'   when  DATEPART(WEEKDAY,data) =7 then 'SABADO' end as 'Dia da Semanda', substring(hora,1,2) + ':00'  as Horario from total where Total.Data >= 'DATAINICIALRELATORIO' AND Total.Data <= 'DATAFINALRELATORIO' group by substring(hora,1,2) , DATEPART(WEEKDAY,data) order by count(CodOrdem) Desc